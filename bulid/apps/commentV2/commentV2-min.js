(function(a,c,b){if(b&&b.apps){b.apps.commentV2={exports:{getComment:function(d){b.apps.require("comment",function(e){function g(h){return h+new Date().valueOf().toString().slice(3)}var f=function(h){this.supperClass=e.comment_init;e.comment_init.call(this,h);this.codeid=g("#J_CodeId");this.codeImgId=g("#J_CodeImgId")};c.extend(f.prototype,e.comment_init.prototype);c.extend(f.prototype,{constructor:f,setNewCode:function(){var h=this;c(h.codeImgId).attr("src",h.getNewCode())},getNewCode:function(){var h=new Date().valueOf();return"http://dev.idongmi.com/api/reply/replyAuth.jsp?t="+h},checkcommit:function(k){var j=k,i=k.config;var l=c.trim(c(i.textid).val()),h=c.trim(c(j.codeid).val());if(l===""){alert("评论不能为空");return}if(h===""){alert("校验码不能为空");return}if(i.deadlock){i.deadlock=false;j.commit()}},initCode:function(){var i=this,h=i.config;c(h.mib).append('<label>验证码: <input type="text" id="'+i.codeid.slice(1)+'" maxlength="4" style="border:#D0D0D0 solid 1px;height:20px;width:50px;"> <img src="'+i.getNewCode()+'" width="65" height="24" alt="校验码" title="点击更换验证码" style="cursor:pointer;" id="'+i.codeImgId.slice(1)+'"></label>');c(i.codeImgId).live("click",function(){i.setNewCode()})},postsuccess:function(k,l,j){var i=j.config;i.deadlock=true;var h=c.trim(k);if(l&&h>0){l(h)}else{if(h==-1){alert("您评论的有点快，去健身休息一下吧！")}else{if(h==-99){alert("校验码不正确")}else{alert("提交失败,请重新尝试")}}}j.setNewCode();c(j.codeid).val("")},postdatalist:function(h){var l=this,k=l.config,i=function(){if(c(k.syncwb).attr("checked")){return 1}else{return 0}},j=c.trim(c(l.codeid).val());return{cid:k.cid,code:j,oid:k.oid,columnid:k.columnid,showuid:k.showuid,puid:k.pids.join(),type:k.type,act:"add",content:h,pid:k.pid,syncwb:i(),reload:1}}});b.widget.use("frameauto",function(h){if(d){d(f,h.frameauto)}})})}}}}})(window,jQuery,GM);